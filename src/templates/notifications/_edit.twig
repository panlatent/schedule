{% extends "_layouts/cp" %}

{% do craft.app.view.registerAssetBundle('panlatent\\schedule\\web\\assets\\notifications\\NotificationsAsset') %}

{% set fullPageForm = true %}

{% import "_includes/forms" as forms %}

{% block content %}
    <input type="hidden" name="action" value="schedule/notifications/save-notification">
    <input type="hidden" name="scheduleId" value="{{ schedule.id }}">
    <input type="hidden" name="id" value="{{ notification.id ?? '' }}">

    {{ redirectInput('schedule/' ~ schedule.id ~ '/notifications') }}

    {{ forms.selectField({
        label: "Notification type"|t('schedule'),
        id: 'notification-type',
        name: 'handle',
        options: notificationTypes,
        value: notification.handle ?? '',
        fieldClass: 'first'
    }) }}

    <div id="notification-settings" data-editing="{{ notification ? 1 : 0 }}">
        {% if notification %}
            {{ forms.lightswitchField({
                label: "Enabled"|t('schedule'),
                on: notification.enabled,
                name: 'enabled'
            }) }}

            {% namespace 'settings' %}
                {% include notification.settingsTemplate with {
                    settings: notification.settingsInstance
                } %}
            {% endnamespace %}
        {% endif %}
    </div>
{% endblock %}